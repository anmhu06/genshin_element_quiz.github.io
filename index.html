<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Which Genshin Element Are You?</title>

<style>
* {
    box-sizing: border-box;
}

body {
    font-family: Arial, sans-serif;
    background-color: #f0f3ff;
    margin: 0;
    padding: 0;
}

.container {
    max-width: 800px;
    margin: 10px auto;
    background: white;
    padding: 15px;
    border-radius: 10px;
}

h1, h2 {
    text-align: center;
}

/* Progress Bar */
#progress-container {
    width: 100%;
    background: #ddd;
    border-radius: 10px;
    height: 14px;
    margin-bottom: 15px;
}

#progress-bar {
    height: 14px;
    width: 0%;
    background: #6a8dff;
    border-radius: 10px;
    transition: width 0.5s ease;
}

#progress-text {
    text-align: center;
    margin: 5px 0 15px 0;
    font-size: 14px;
    color: #555;
}

/* Animations */
#quiz {
    transition: opacity 0.4s ease, transform 0.4s ease;
}

.fade-out {
    opacity: 0;
    transform: translateY(10px);
}

.fade-in {
    opacity: 1;
    transform: translateY(0px);
}

.options button {
    display: block;
    margin: 8px 0;
    padding: 14px;
    width: 100%;
    font-size: 18px;
    cursor: pointer;
    border-radius: 8px;
    border: 1px solid #ccc;
    transition: transform 0.2s ease, background-color 0.2s ease;
}

.options button:hover {
    background-color: #f0f0f0;
    transform: scale(1.02);
}

#result {
    text-align: center;
    font-size: 18px;
    margin-top: 20px;
    padding: 20px;
    border-radius: 10px;
    color: black;
}

.divider {
    border: none;
    border-top: 2px solid rgba(0,0,0,0.2);
    margin: 15px 0;
}

#restart {
    margin-top: 20px;
    padding: 12px;
    font-size: 16px;
    cursor: pointer;
    border-radius: 8px;
}

.element-pic {
    width: 120px;
    margin: 10px auto;
    display: block;
}
</style>
</head>

<body>

<div class="container">
    <h1>Which Genshin Impact Element Are You?</h1>

    <div id="progress-container">
        <div id="progress-bar"></div>
    </div>

    <div id="progress-text"></div>

    <div id="quiz"></div>
    <div id="result"></div>
</div>

<!-- Confetti Library -->
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>

<script>

// ----- IMAGE PATHS -----
const elementImages = {
    Pyro: "genshin_quiz_images/Pyro.png",
    Hydro: "genshin_quiz_images/Hydro.png",
    Cryo: "genshin_quiz_images/Cryo.png",
    Anemo: "genshin_quiz_images/Anemo.png",
    Geo: "genshin_quiz_images/Geo.png",
    Electro: "genshin_quiz_images/Electro.png",
    Dendro: "genshin_quiz_images/Dendro.png"
};

// ----- COLORS -----
const elementColors = {
    Pyro: "rgba(255, 150, 150, 0.9)",
    Hydro: "rgba(140, 190, 255, 0.9)",
    Cryo: "rgba(190, 230, 255, 0.9)",
    Anemo: "rgba(160, 230, 210, 0.9)",
    Geo: "rgba(255, 235, 150, 0.9)",
    Electro: "rgba(200, 160, 255, 0.9)",
    Dendro: "rgba(170, 230, 160, 0.9)"
};

const solidColors = {
    Pyro: "#e63939",
    Hydro: "#1e90ff",
    Cryo: "#5fcfff",
    Anemo: "#2ed8b6",
    Geo: "#e6c200",
    Electro: "#9b59ff",
    Dendro: "#2e8b2e"
};

function darkenColor(rgba) {
    let nums = rgba.match(/\d+/g);
    let r = Math.max(0, nums[0] - 80);
    let g = Math.max(0, nums[1] - 80);
    let b = Math.max(0, nums[2] - 80);
    return `rgb(${r}, ${g}, ${b})`;
}

// ðŸŽ‰ CONFETTI FUNCTION
function launchConfetti() {
    const duration = 2.5 * 1000;
    const end = Date.now() + duration;

    (function frame() {
        confetti({
            particleCount: 5,
            angle: 60,
            spread: 55,
            origin: { x: 0 }
        });

        confetti({
            particleCount: 5,
            angle: 120,
            spread: 55,
            origin: { x: 1 }
        });

        if (Date.now() < end) {
            requestAnimationFrame(frame);
        }
    })();
}

// ----- QUESTIONS -----
const questions = [
    {
        text: "Pick a fruit:",
        answers: [
            { text: "Strawberries", element: ["Pyro", "Dendro"] },
            { text: "Lemon", element: ["Geo"] },
            { text: "Apples", element: ["Anemo"] },
            { text: "Blueberry", element: ["Electro", "Hydro"] },
            { text: "Oranges", element: ["Dendro"] },
            { text: "Peaches", element: ["Cryo", "Pyro"] },
            { text: "Mango", element: ["Hydro", "Geo"] }
        ]
    },
    {
        text: "Choose a personality trait:",
        answers: [
            { text: "Bold and passionate", element: ["Pyro"] },
            { text: "Calm and adaptable", element: ["Hydro"] },
            { text: "Free-spirited", element: ["Anemo"] },
            { text: "Analytical", element: ["Electro"] },
            { text: "Reliable and grounded", element: ["Geo"] },
            { text: "Kind and nurturing", element: ["Dendro"] },
            { text: "Quiet and reserved", element: ["Cryo"] }
        ]
    },
    {
        text: "Choose a dessert:",
        answers: [
            { text: "Chocolate cake", element: ["Pyro"] },
            { text: "Ice cream", element: ["Cryo"] },
            { text: "Fruit tart", element: ["Dendro"] },
            { text: "Waffles", element: ["Anemo"] },
            { text: "Cheesecake", element: ["Geo"] },
            { text: "Tiramisu", element: ["Hydro"] },
            { text: "Carrot cake", element: ["Electro"] }
        ]
    }
];

let currentQuestion = 0;

let scores = {
    Pyro: 0,
    Hydro: 0,
    Anemo: 0,
    Electro: 0,
    Geo: 0,
    Cryo: 0,
    Dendro: 0
};

let userChoices = [];

function updateProgress() {
    let percent = (currentQuestion / questions.length) * 100;

    document.getElementById("progress-bar").style.width = percent + "%";

    document.getElementById("progress-text").textContent =
        `Question ${currentQuestion + 1} of ${questions.length}`;
}

function loadQuestion() {
    const quizDiv = document.getElementById("quiz");
    const resultDiv = document.getElementById("result");

    quizDiv.classList.add("fade-out");

    setTimeout(() => {

        quizDiv.innerHTML = "";
        resultDiv.innerHTML = "";

        if (currentQuestion >= questions.length) {
            showResult();
            return;
        }

        updateProgress();

        const q = questions[currentQuestion];

        const title = document.createElement("h2");
        title.textContent = q.text;
        quizDiv.appendChild(title);

        const optionsDiv = document.createElement("div");
        optionsDiv.className = "options";

        q.answers.forEach(answer => {
            const btn = document.createElement("button");
            btn.textContent = answer.text;

            btn.onclick = () => {
                answer.element.forEach(el => scores[el]++);

                userChoices.push({
                    question: q.text,
                    choice: answer.text,
                    element: answer.element.join(", ")
                });

                currentQuestion++;
                loadQuestion();
            };

            optionsDiv.appendChild(btn);
        });

        quizDiv.appendChild(optionsDiv);

        quizDiv.classList.remove("fade-out");
        quizDiv.classList.add("fade-in");

    }, 350);
}

function showResult() {
    const resultDiv = document.getElementById("result");

    document.getElementById("progress-container").style.display = "none";
    document.getElementById("progress-text").style.display = "none";

    const topElement = Object.keys(scores).reduce((a, b) =>
        scores[a] > scores[b] ? a : b
    );

    resultDiv.style.backgroundColor = elementColors[topElement];

    let headingColor = darkenColor(elementColors[topElement]);

    resultDiv.innerHTML = `
        <img class="element-pic"
             src="${elementImages[topElement]}"
             onerror="this.style.display='none'">

        <h2 style="color:${headingColor}">
            You are aligned with the ${topElement} element!
        </h2>

        <hr class="divider">

        <h3 style="color:${headingColor}">Your Choices:</h3>

        ${userChoices.map(c =>
            `<p><strong>${c.question}</strong> â†’ ${c.choice} (${c.element})</p>`
        ).join("")}

        <hr class="divider">

        <h3 style="color:${headingColor}">Element Breakdown:</h3>

        ${Object.entries(scores).map(([el, sc]) =>
            `<p style="color:${solidColors[el]}">${el}: ${sc}</p>`
        ).join("")}

        <button id="restart" onclick="restartQuiz()">Restart Quiz</button>
    `;

    // ðŸŽ‰ PARTY TIME
    launchConfetti();
}

function restartQuiz() {
    currentQuestion = 0;

    scores = {
        Pyro: 0,
        Hydro: 0,
        Anemo: 0,
        Electro: 0,
        Geo: 0,
        Cryo: 0,
        Dendro: 0
    };

    userChoices = [];

    document.getElementById("progress-container").style.display = "block";
    document.getElementById("progress-text").style.display = "block";

    loadQuestion();
}

loadQuestion();

</script>

</body>
</html>
